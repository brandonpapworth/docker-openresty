daemon  off;
pcre_jit  on;
error_log  /dev/stderr  info;
worker_processes  auto;

include env_vars_available.conf;

events {
    worker_connections  2048;
    use  epoll;
    multi_accept  on;
}

http {
    include  mime.types;
    default_type  application/octet-stream;

    #log_format  main  '$remote_addr - $remote_user [$time_local] "$request" '
    #                  '$status $body_bytes_sent "$http_referer" '
    #                  '"$http_user_agent" "$http_x_forwarded_for"';

    #access_log  logs/access.log  main;

    sendfile  on;
    tcp_nodelay  on;
    tcp_nopush  on;
    types_hash_max_size  2048;
    keepalive_timeout  65;
    server_names_hash_bucket_size  64;
    gzip  on;


    lua_code_cache  on;
    #lua_package_path  "/data/openresty/lualib/?.lua;;";
    lua_shared_dict  cache  16m;
    lua_shared_dict  locks  16m;
    init_by_lua_block {
        require "resty.core"
    }
    init_worker_by_lua_block {
        local env = require "util.env"
    }

    include  sites_enabled/*.conf;
}
